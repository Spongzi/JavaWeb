# 反射：框架设计的灵魂

Java在工作的过程中有三个阶段： 第一阶段属于Source源码阶段 --> 编写过程 第二阶段属于Class类对象阶段 --> ClassLoader --> 类加载器 第三阶段属于RunTime运行阶段 --> 创建对象

- 反射：将类的各个部分封装为其他对象，这就是反射的机制
    - 好处：
        1. 可以在程序运行过程中，操作这些对象
        2. 可以解耦，降低程序的耦合性，提高程序的可扩展性

- 获取Class对象的方式
    - Java代码处于第一阶段的时候：Class.forName("全类名");将字节码文件放入内存，返回Class对象
        - 多用于配置文件中，将类名定义在配置文件中。读取文件，加载类
    - Java代码处于第二阶段的时候；类名.class;通过类名获取Class对象
        - 多用于参数传递
    - Java代码处于第三阶段的时候：对象.getClass();通过对象的方法获取，getClass()是在Object对象中定义的
        - 多用于对象的获取字节码
        - 结论：
            - 同字节码文件(*.class)在一次程序的运行过程中只会被执行一次，不论通过那种方式获取Class对象都是同一个。
- Class对象的功能：
    1. 获取成员变量们
   ```java
      Filed[] getFileds() // 是用来获取所有public的成员变量
      Filed getFiled(String name)// 是用来获取指定名称的public的成员变量
      Filed[] getDeclaredFields() // 不考虑修饰符
      Filed getDeclaredField(String name)
  ```
  2. 获取构造方法们
     ```java
       Constructor<?>[] getConstructors()
       Constructor<?> getConstructor(类<?>... parmeterTypes)
       Constructor<?>[] getDeclaredConstructors()
       Constructor<?> getDeclaredConstructor(类<?>... parmeterTypes)
     ```
   3. 获取成员方法们
      ```java
        Method[] getMethods()
        Method getMethod(类<?>... parmeterTypes)
        Method[] getDeclaredMethods()
        Method getDeclaredMethod(类<?>... parmeterTypes)
      ```
   4. 获取类名
      ```java
          String getName()
      ```
   
- 获取成员变量：
  - 操作；
    - 设置值：set
    - 获取值：get
    - 忽略安全访问权限：setAccessible(true) ；暴力反射
- 获取成员方法：
  - 操作
    - 创建对象NewInstance(Object... initargs)
    - 如果使用空参创建对象的时候操作可以简化：Class对象的NewInstance()

## 案例：
  需求：写一个"框架"，可以帮我们创建任意类的对象，并且执行其中任意的方法
  实现：
    1. 配置文件
    2. 反射
  步骤：
    1. 将需要创建的对象的全类名和需要执行的方法定义在配置文件中
    2. 在程序中加载读取配置文件
    3. 使用反射技术来加载文件内存
    4. 创建对象
    5. 执行方法
